function EI = Infinity(b0,bn,I,flag)

if flag==1
    CMat=ReadCMat(1,1); % stiffness constants
    C=CMat(:,:,1);
elseif flag==2
    CMat=ReadCMat(2,I); 
    C=CMat(:,:,I);
end

B=zeros(6,6,1); % reduced stiffness constants
for i=1:6
    for j=1:6
        B(i,j)=C(i,j)-C(i,3)*C(3,j)/C(3,3);
    end
end

a=B(2,2)*B(4,4)-B(2,4)^2;
b=B(2,4)*(2*B(1,4)+B(2,4)+2*B(5,6))-B(4,4)*(B(1,1)+2*B(1,2)+B(2,2)+B(6,6))-B(2,2)*B(5,5)+B(1,4)^2;
c=B(5,5)*(B(1,1)+2*B(1,2)+B(2,2)+B(6,6))-B(5,6)^2;
m1=(-b+sqrt(b^2-4*a*c))/2/a;
m1=sqrt(m1);
m3=(-b-sqrt(b^2-4*a*c))/2/a;
m3=sqrt(m3);
m=[m1 -m1 m3 -m3];
for i=1:4
    g(i)=B(2,4)*m(i)^3+(B(1,4)+B(2,4))*m(i)^2-B(5,6)*m(i);
    g(i)=g(i)/(B(4,4)*m(i)^2-B(5,5));
    alpha(i)=pi*(C(1,3)+C(2,3)*(m(i)+1)-C(3,4)*g(i)*m(i));
    alpha(i)=alpha(i)/(m(i)+2)/C(3,3);
    alphap(i)=alpha(i)*(2+m(i));
end
tempMatrix=inv([-2*B(1,4)-6*B(2,4)+B(5,6), 4*B(4,4)-B(5,5);...
                -B(1,1)-2*B(1,2)+3*B(2,2)-B(6,6), -2*B(1,4)-2*B(2,4)+B(5,6)]);
tempVec=[2*C(3,4), C(1,3)-C(2,3)]';
mu=tempMatrix*tempVec/C(3,3);
beta=mu(1)*(C(1,3)+3*C(2,3))-2*mu(2)*C(3,4)-1;
beta=pi*beta/C(3,3)/4;

 C1=(-2*g(3)*g(4)*(2 + m(1))*m(3)*mu(1) + ...
     g(2)*(g(4)*(m(1) - m(3))*(-2 + m(3)) + ...
        g(3)*(2 + m(3))*(m(1) + m(3)))*mu(1) + ...
     g(3)*(m(1) - m(3))*(-2 + m(3))*mu(2) - ...
     2*g(2)*(2 + m(1))*m(3)*mu(2) + ...
     g(4)*(2 + m(3))*(m(1) + m(3))*mu(2))/ ...
   ((g(1) - g(2))*(g(3) - g(4))*power(m(1),2) - ...
     2*(-2*g(3)*g(4) + g(2)*(g(3) + g(4)) + ...
        g(1)*(-2*g(2) + g(3) + g(4)))*m(1)*m(3) + ...
     (g(1) - g(2))*(g(3) - g(4))*power(m(3),2));
C2=(-2*g(3)*g(4)*(-2 + m(1))*m(3)*mu(1) + ...
     g(1)*(g(3)*(m(1) - m(3))*(2 + m(3)) + ...
        g(4)*(-2 + m(3))*(m(1) + m(3)))*mu(1) - ...
     2*g(1)*(-2 + m(1))*m(3)*mu(2) + ...
     g(4)*(m(1) - m(3))*(2 + m(3))*mu(2) + ...
     g(3)*(-2 + m(3))*(m(1) + m(3))*mu(2))/ ...
   (4*g(3)*g(4)*m(1)*m(3) - ...
     g(2)*(-(g(4)*power(m(1) - m(3),2)) + ...
        g(3)*power(m(1) + m(3),2)) + ...
     g(1)*(g(3)*power(m(1) - m(3),2) + 4*g(2)*m(1)*m(3) - ...
        g(4)*power(m(1) + m(3),2)));
C3=(-(g(2)*g(4)*(-2 + m(1))*(m(1) - m(3))*mu(1)) - ...
     g(1)*(2*g(2)*m(1)*(2 + m(3)) - ...
        g(4)*(2 + m(1))*(m(1) + m(3)))*mu(1) - ...
     g(1)*(-2 + m(1))*(m(1) - m(3))*mu(2) - ...
     2*g(4)*m(1)*(2 + m(3))*mu(2) + ...
     g(2)*(2 + m(1))*(m(1) + m(3))*mu(2))/ ...
   (4*g(3)*g(4)*m(1)*m(3) - ...
     g(2)*(-(g(4)*power(m(1) - m(3),2)) + ...
        g(3)*power(m(1) + m(3),2)) + ...
     g(1)*(g(3)*power(m(1) - m(3),2) + 4*g(2)*m(1)*m(3) -... 
        g(4)*power(m(1) + m(3),2)));
C4=(g(1)*(-(g(3)*(2 + m(1))*(m(1) - m(3))) - ...
        2*g(2)*m(1)*(-2 + m(3)))*mu(1) + ...
     g(2)*g(3)*(-2 + m(1))*(m(1) + m(3))*mu(1) - ...
     g(2)*(2 + m(1))*(m(1) - m(3))*mu(2) - ...
     2*g(3)*m(1)*(-2 + m(3))*mu(2) + ...
     g(1)*(-2 + m(1))*(m(1) + m(3))*mu(2))/ ...
   (4*g(3)*g(4)*m(1)*m(3) - ...
     g(2)*(-(g(4)*power(m(1) - m(3),2)) + ...
        g(3)*power(m(1) + m(3),2)) + ...
     g(1)*(g(3)*power(m(1) - m(3),2) + 4*g(2)*m(1)*m(3) - ...
        g(4)*power(m(1) + m(3),2)));
EI=(alphap(1)*C1+alphap(2)*C2+alphap(3)*C3+alphap(4)*C4+4*beta);
EI=-EI*(bn^4-b0^4)/4;

end
