clc
clear
close all

s1 = zeros(6,6);
s2 = zeros(6,6);
de = zeros(6,6);
se = zeros(6,6);

s1(1,1) = 1.052632e-4; s1(1,2) = -6.456815e-6; s1(1,3) = -8.280027e-6; s1(1,4) = 1.052632e-6;
s1(2,2) = 1.263265e-4; s1(2,3) = -2.463235e-5; s1(2,4) = -2.831390e-5;
s1(3,3) = 4.176170e-5; s1(3,4) =  7.713743e-5; s1(4,4) =  3.391176e-4; 
s1(5,5) = 4.832532e-4; s1(5,6) = -6.250000e-5; s1(6,6) =  2.667468e-4;
s1(2,1) = s1(1,2); s1(3,1) = s1(1,3); s1(4,1) = s1(1,4);
s1(3,2) = s1(2,3); s1(4,2) = s1(2,4); s1(4,3) = s1(3,4);
s1(6,5) = s1(5,6);

s2(1,1) = 1.052632e-4; s2(1,2) = -6.691803e-6; s2(1,3) = -8.045040e-6; s2(1,4) = -1.612725e-6;
s2(2,2) = 1.359339e-4; s2(2,3) = -4.513900e-5; s2(2,4) =  2.255642e-5;
s2(3,3) = 7.316760e-5; s2(3,4) = -9.735841e-5; s2(4,4) =  2.570911e-4; 
s2(5,5) = 4.553485e-4; s2(5,6) =  9.575556e-5; s2(6,6) =  2.946515e-4;
s2(2,1) = s2(1,2); s2(3,1) = s2(1,3); s2(4,1) = s2(1,4);
s2(3,2) = s2(2,3); s2(4,2) = s2(2,4); s2(4,3) = s2(3,4);
s2(6,5) = s2(5,6);

d1 = inv(s1); d2 = inv(s2);

savrg = (s1+s2)/2; davrg = (d1+d2)/2;

de(1,1) = 2*d1(1,1)*d2(1,1)/(d1(1,1)+d2(1,1));
de(1,2) = (d1(1,1)*d2(1,2)+d2(1,1)*d1(1,2))/(d1(1,1)+d2(1,1)); de(2,1) = de(1,2);
de(1,3) = (d1(1,1)*d2(1,3)+d2(1,1)*d1(1,3))/(d1(1,1)+d2(1,1)); de(3,1) = de(1,3);
de(1,4) = (d1(1,1)*d2(1,4)+d2(1,1)*d1(1,4))/(d1(1,1)+d2(1,1)); de(4,1) = de(1,4);
de(2,2) = (d1(2,2)+d2(2,2))/2;
de(2,3) = (d1(1,2)-d2(1,2))*(d2(1,3)-d1(1,3))+(d1(1,1)+d2(1,1))*(d1(2,3)+d2(2,3));
de(2,3) = de(2,3)/2/(d1(1,1)+d2(1,1)); de(3,2) =de(2,3);
de(2,4) = (d1(1,2)-d2(1,2))*(d2(1,4)-d1(1,4))+(d1(1,1)+d2(1,1))*(d1(2,4)+d2(2,4));
de(2,4) = de(2,4)/2/(d1(1,1)+d2(1,1)); de(4,2) =de(2,4);
de(3,3) = (d1(3,3)+d2(3,3))/2;
de(3,4) = (d1(1,3)-d2(1,3))*(d2(1,4)-d1(1,4))+(d1(1,1)+d2(1,1))*(d1(3,4)+d2(3,4));
de(3,4) = de(3,4)/2/(d1(1,1)+d2(1,1)); de(4,3) =de(3,4);
de(4,4) = (d1(4,4)+d2(4,4))/2;
de(5,5) = d1(5,5)*d2(5,6)^2+d2(5,5)*(d1(5,6)^2-d1(5,5)*(d1(6,6)+d2(6,6)));
de(5,5) = 2*de(5,5)/((d1(5,6)+d2(5,6))^2-(d1(5,5)+d2(5,5))*(d1(6,6)+d2(6,6)));
de(5,6) = d1(5,6)*d2(5,6)*(d1(5,6)+d2(5,6))-d1(5,5)*d1(6,6)*d2(5,6)-d2(5,5)*d2(6,6)*d1(5,6);
de(5,6) = 2*de(5,6)/((d1(5,6)+d2(5,6))^2-(d1(5,5)+d2(5,5))*(d1(6,6)+d2(6,6))); de(6,5) = de(5,6);
de(6,6) = d1(6,6)*d2(5,6)^2+d2(6,6)*(d1(5,6)^2-d1(6,6)*(d1(5,5)+d2(5,5)));
de(6,6) = 2*de(6,6)/((d1(5,6)+d2(5,6))^2-(d1(5,5)+d2(5,5))*(d1(6,6)+d2(6,6)));

%
se(1,1) = 2*s1(1,1)*s2(1,1)/(s1(1,1)+s2(1,1));
se(1,2) = (s1(1,1)*s2(1,2)+s2(1,1)*s1(1,2))/(s1(1,1)+s2(1,1)); se(2,1) = se(1,2);
se(1,3) = (s1(1,1)*s2(1,3)+s2(1,1)*s1(1,3))/(s1(1,1)+s2(1,1)); se(3,1) = se(1,3);
se(1,4) = (s1(1,1)*s2(1,4)+s2(1,1)*s1(1,4))/(s1(1,1)+s2(1,1)); se(4,1) = se(1,4);
se(2,2) = (s1(2,2)+s2(2,2))/2;
se(2,3) = (s1(1,2)-s2(1,2))*(s2(1,3)-s1(1,3))+(s1(1,1)+s2(1,1))*(s1(2,3)+s2(2,3));
se(2,3) = se(2,3)/2/(s1(1,1)+s2(1,1)); se(3,2) =se(2,3);
se(2,4) = (s1(1,2)-s2(1,2))*(s2(1,4)-s1(1,4))+(s1(1,1)+s2(1,1))*(s1(2,4)+s2(2,4));
se(2,4) = se(2,4)/2/(s1(1,1)+s2(1,1)); se(4,2) =se(2,4);
se(3,3) = (s1(3,3)+s2(3,3))/2;
se(3,4) = (s1(1,3)-s2(1,3))*(s2(1,4)-s1(1,4))+(s1(1,1)+s2(1,1))*(s1(3,4)+s2(3,4));
se(3,4) = se(3,4)/2/(s1(1,1)+s2(1,1)); se(4,3) =se(3,4);
se(4,4) = (s1(4,4)+s2(4,4))/2;
se(5,5) = s1(5,5)*s2(5,6)^2+s2(5,5)*(s1(5,6)^2-s1(5,5)*(s1(6,6)+s2(6,6)));
se(5,5) = 2*se(5,5)/((s1(5,6)+s2(5,6))^2-(s1(5,5)+s2(5,5))*(s1(6,6)+s2(6,6)));
se(5,6) = s1(5,6)*s2(5,6)*(s1(5,6)+s2(5,6))-s1(5,5)*s1(6,6)*s2(5,6)-s2(5,5)*s2(6,6)*s1(5,6);
se(5,6) = 2*se(5,6)/((s1(5,6)+s2(5,6))^2-(s1(5,5)+s2(5,5))*(s1(6,6)+s2(6,6))); se(6,5) = se(5,6);
se(6,6) = s1(6,6)*s2(5,6)^2+s2(6,6)*(s1(5,6)^2-s1(6,6)*(s1(5,5)+s2(5,5)));
se(6,6) = 2*se(6,6)/((s1(5,6)+s2(5,6))^2-(s1(5,5)+s2(5,5))*(s1(6,6)+s2(6,6)));


